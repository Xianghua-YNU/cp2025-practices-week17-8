# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [秦铭阳] **学号：** [20231050162] **完成日期：** [2025.6.18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 核心代码段
# 例如：FTCS更新公式的实现
# for j in range(1, t.size - 1):
#     u[1:-1, j + 1] = c_val * (u[2:, j] + u[:-2, j]) + 2 * (1 - c_val) * u[1:-1, j] - u[1:-1, j - 1]
```

## 3. 实验结果

### 3.1 主要输出

[请在此处插入关键数值结果或生成的动画截图/描述。例如，不同时间点的弦形图，或动画的简要描述。]
结果显示，弦在初始扰动后开始振动。例如，如果初始位移是一个半波正弦波（φ(x) = sin(πx/L)），弦会以基频振荡。在 t = T/4 时，弦达到最大位移（相对于平衡位置）；在 t = T/2 时，弦回到平衡位置但位移方向相反；在 t = T 时，弦回到初始状态，完成一个周期。通过绘制不同时间点（如 t=0, T/8, T/4, T/2, 3T/4, T）的弦形图，可以清晰地看到这种周期性振荡。如果生成了动画，可以看到弦的波形在两端固定点之间来回传播和反射。
[此处可以插入几幅关键时间点的弦形图，或者描述动画效果。例如：“生成的动画显示，初始的半正弦波在弦上传播，遇到固定端后发生反射，波形逐渐叠加，形成复杂的干涉图案，但整体呈现出周期性的振荡行为。

### 3.2 结果验证

[请在此处描述如何验证你的结果的正确性。例如，是否满足边界条件？波形是否符合预期？是否观察到数值稳定性问题？]
边界条件满足：** 检查结果中，对于所有时间步 j，u[0, j] 和 u[-1, j] 始终为零，符合两端固定的边界条件。
*   **波形符合预期：** 对于简单的初始条件（如半正弦波），观察到的振动模式（如基频振荡）与解析解或物理直觉相符。波形在传播和反射过程中没有出现不合理的变形（在满足稳定性条件下）。
*   **数值稳定性：** 当选择的 Δt 和 Δx 满足 CFL 条件 (c * Δt / Δx ≤ 1) 时，数值解是稳定的，波形不会随时间无限增长或出现剧烈振荡。如果尝试使用不满足条件的参数，会观察到解的快速发散。
*   **能量守恒（定性）：** 对于无阻尼系统，虽然数值方法可能引入微小误差，但整体波形能量的剧烈损失或增长通常意味着数值不稳定或实现错误。观察振幅随时间的变化可以初步判断。
  
## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？
*   如何确保数值稳定性？
*   动画制作中的挑战？]
* 1.  **如何正确处理初始速度条件 ψ(x)？** 初始速度为零时还好处理，但当初始速度非零时，如何从 ψ(x) 计算出第一个时间步 u[:, 1] 的值，同时保持数值格式的二阶精度，是一个难点。
  2.  **如何确保数值稳定性？** 理解并验证 CFL 条件 (c * Δt / Δx ≤ 1) 在实际代码中如何体现，以及不满足条件时会出现什么现象，需要通过实验来体会。

### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。
*   调整时间步长以满足CFL条件。
*   学习Matplotlib动画模块的使用。]
*   1.  **处理初始速度：** 查阅资料了解到，可以在 t=0 处对 u[i, 1] 进行泰勒展开：u[i, 1] ≈ u[i, 0] + Δt * ∂u/∂t|_(t=0) + (Δt²/2) * ∂²u/∂t²|_(t=0)。利用初始速度 ψ(x) = ∂u/∂t|_(t=0) 和波动方程 ∂²u/∂t² = c² ∂²u/∂x²|_(t=0)，可以将 ∂²u/∂t²|_(t=0) 用初始位移 φ(x) 表示出来，从而解出 u[:, 1]。这确保了初始条件的正确离散化。
    2.  **确保稳定性：** 通过理论计算确定 CFL 条件，然后在代码中设定 Δt 时确保 c_val = (c * Δt / Δx)² ≤ 1。通过尝试不同的 Δt 值进行实验，观察当 c_val > 1 时解的快速发散，从而加深对稳定性条件的理解。

### 4.3 主要收获

[请在此处总结你在本次实验中的3-5句话学习收获，例如：
*   加深了对波动方程和有限差分法的理解。
*   掌握了Python进行科学计算和可视化的技能。
*   认识到数值模拟中稳定性条件的重要性。]
*   通过本次实验，我深入理解了一维波动方程的FTCS数值解法，特别是其离散化过程和迭代更新机制。掌握了如何将物理问题（弦振动）转化为可计算的数学模型，并使用Python实现了这一过程。认识到数值稳定性条件（CFL条件）对于保证解的正确性和可靠性至关重要，并学会了通过调整时间步长和空间步长来满足这一条件。此外，通过可视化结果，直观地观察到了波的传播、反射和干涉现象，加深了对波动物理过程的理解。同时，也锻炼了使用Python进行科学计算和动画可视化的能力。

## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？初始速度剖面的形状直接影响弦的初始动量分布。例如，如果初始速度为零，弦会从静止的初始位移开始振动；如果初始速度是一个脉冲，弦会像一个“锤击”后开始振动，可能激发多个频率的振动模式；如果初始速度是一个斜坡，弦会整体开始运动并伴随振动。总的来说，不同的初始速度会导致弦以不同的组合频率和振幅进行振动，最终形成的振动模式是初始位移和初始速度共同作用的结果。

2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？ 当 Δt 和 Δx 的比值满足 c_val < 1 时，数值解通常是稳定的，波形能够正确传播和反射。减小 Δt 和/或 Δx（即提高空间和时间分辨率）通常会提高解的准确性，但会增加计算量。如果 Δt 相对于 Δx 过大，使得 c_val ≥ 1，数值解会变得不稳定。具体表现为：弦的位移在短时间内急剧增大，波形出现不真实的振荡和扭曲，最终数值解发散到无穷大。这是因为信息在物理空间中的传播速度有限（为 c），而数值格式在 c_val > 1 时无法正确捕捉这种有限传播速度，导致虚假的“信息”在单步内跨越了超过 Δx 的距离，破坏了解的物理意义。
